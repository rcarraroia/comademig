================================================================================
                    PLANO DE AÃ‡ÃƒO PRIORITÃRIO - COMADEMIG
================================================================================
Data: 2025-11-26
Baseado em: RelatÃ³rio Completo de Testes
Status: AGUARDANDO APROVAÃ‡ÃƒO E EXECUÃ‡ÃƒO

================================================================================
SUMÃRIO EXECUTIVO
================================================================================

Total de Problemas Identificados: 24
ðŸ”´ CrÃ­ticos (AÃ§Ã£o Imediata): 5
ðŸŸ  Altos (AÃ§Ã£o Urgente): 7
ðŸŸ¡ Moderados (AÃ§Ã£o Importante): 8
ðŸŸ¢ Baixos (AÃ§Ã£o DesejÃ¡vel): 4

Tempo Estimado Total: 2-3 semanas
Custo Estimado: VariÃ¡vel (depende da equipe)
Risco se NÃ£o Corrigido: ALTÃSSIMO

================================================================================
FASE 1: EMERGÃŠNCIA (HOJE - 24 HORAS)
================================================================================
Objetivo: Corrigir problemas de seguranÃ§a e bloqueadores crÃ­ticos
Prioridade: MÃXIMA
ResponsÃ¡vel: Equipe completa
Tempo Estimado: 4-8 horas

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 1.1: SEGURANÃ‡A - Remover Chaves Expostas
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸ”´ CRÃTICA MÃXIMA
Tempo: 30 minutos
ResponsÃ¡vel: DevOps + SeguranÃ§a

Passos:
1. [ ] Fazer backup do arquivo .env localmente
2. [ ] Remover .env do histÃ³rico do Git:
    ```bash
    git filter-branch --force --index-filter \
    "git rm --cached --ignore-unmatch .env" \
    --prune-empty --tag-name-filter cat -- --all
    ```
3. [ ] ForÃ§ar push para remover do remoto:
    ```bash
    git push origin --force --all
    ```
4. [ ] Verificar que .env estÃ¡ no .gitignore (jÃ¡ estÃ¡)
5. [ ] Notificar equipe para nÃ£o usar as chaves antigas

VerificaÃ§Ã£o:
- [ ] Arquivo .env nÃ£o aparece no histÃ³rico do Git
- [ ] Arquivo .env nÃ£o estÃ¡ no repositÃ³rio remoto
- [ ] .gitignore contÃ©m .env

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 1.2: SEGURANÃ‡A - Rotacionar Todas as Chaves
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸ”´ CRÃTICA MÃXIMA
Tempo: 1 hora
ResponsÃ¡vel: DevOps + Backend

Chaves a Rotacionar:

1. [ ] SUPABASE_SERVICE_ROLE_KEY
   - Acessar: https://supabase.com/dashboard/project/amkelczfwazutrciqtlk/settings/api
   - Gerar nova service_role key
   - Atualizar em variÃ¡veis de ambiente de produÃ§Ã£o
   - Revogar chave antiga

2. [ ] ASAAS_API_KEY
   - Acessar: https://www.asaas.com/config/api
   - Gerar nova API key
   - Atualizar em Edge Functions secrets
   - Revogar chave antiga

3. [ ] ASAAS_WEBHOOK_TOKEN
   - Gerar novo token aleatÃ³rio seguro
   - Atualizar em Edge Functions
   - Atualizar configuraÃ§Ã£o de webhook no Asaas

4. [ ] VITE_ENCRYPTION_KEY
   - Gerar nova chave de criptografia
   - Migrar dados criptografados (se houver)
   - Atualizar em produÃ§Ã£o

Comandos para Atualizar Secrets:
```bash
cd E:\PROJETOS SITE\repositorios\comademig
supabase secrets set ASAAS_API_KEY=nova_chave_aqui
supabase secrets set ASAAS_WEBHOOK_TOKEN=novo_token_aqui
```

VerificaÃ§Ã£o:
- [ ] Todas as chaves antigas revogadas
- [ ] Todas as chaves novas funcionando
- [ ] Sistema operacional com novas chaves
- [ ] Logs verificados para atividades suspeitas

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 1.3: INFRAESTRUTURA - Linkar Supabase CLI
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸ”´ CRÃTICA
Tempo: 15 minutos
ResponsÃ¡vel: Backend

Passos:
1. [ ] Verificar se CLI estÃ¡ instalado:
    ```bash
    supabase --version
    ```
2. [ ] Fazer login (se necessÃ¡rio):
    ```bash
    supabase login
    ```
3. [ ] Linkar ao projeto:
    ```bash
    cd E:\PROJETOS SITE\repositorios\comademig
    supabase link --project-ref amkelczfwazutrciqtlk
    ```
4. [ ] Verificar conexÃ£o:
    ```bash
    supabase status
    ```

VerificaÃ§Ã£o:
- [ ] CLI linkado com sucesso
- [ ] Comando supabase status funciona
- [ ] PossÃ­vel executar queries

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 1.4: BANCO DE DADOS - Regenerar types.ts
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸ”´ CRÃTICA
Tempo: 10 minutos
ResponsÃ¡vel: Backend

Passos:
1. [ ] Gerar tipos TypeScript do banco:
    ```bash
    supabase gen types typescript --linked > src/integrations/supabase/types.ts
    ```
2. [ ] Verificar arquivo gerado
3. [ ] Corrigir imports se necessÃ¡rio
4. [ ] Testar compilaÃ§Ã£o:
    ```bash
    npm run build
    ```

VerificaÃ§Ã£o:
- [ ] Arquivo types.ts nÃ£o estÃ¡ vazio
- [ ] Tipos correspondem ao banco de dados
- [ ] CompilaÃ§Ã£o TypeScript sem erros

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 1.5: BANCO DE DADOS - Verificar Member Types
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸ”´ BLOQUEADOR
Tempo: 2 horas
ResponsÃ¡vel: Backend + DBA

Passos:
1. [ ] Verificar se tabela member_types existe:
    ```bash
    supabase db execute "SELECT * FROM member_types LIMIT 5"
    ```

2. [ ] Verificar se tabela member_type_subscriptions existe:
    ```bash
    supabase db execute "SELECT * FROM member_type_subscriptions LIMIT 5"
    ```

3. [ ] Verificar se tabela subscription_plans existe:
    ```bash
    supabase db execute "SELECT * FROM subscription_plans LIMIT 5"
    ```

4. [ ] Se tabelas estiverem vazias, popular com dados de teste:
    ```sql
    -- Inserir tipos de membro
    INSERT INTO member_types (name, description, is_active, sort_order) VALUES
    ('Pastor', 'Ministro ordenado responsÃ¡vel por uma igreja', true, 1),
    ('Evangelista', 'Ministro itinerante focado em evangelizaÃ§Ã£o', true, 2),
    ('DiÃ¡cono', 'Auxiliar ministerial', true, 3),
    ('Membro', 'Membro regular da convenÃ§Ã£o', true, 4);

    -- Inserir planos de assinatura
    INSERT INTO subscription_plans (name, price, recurrence, description) VALUES
    ('Plano Mensal Pastor', 50.00, 'monthly', 'Assinatura mensal para pastores'),
    ('Plano Anual Pastor', 500.00, 'annual', 'Assinatura anual para pastores'),
    ('Plano Mensal Evangelista', 40.00, 'monthly', 'Assinatura mensal para evangelistas'),
    ('Plano Mensal DiÃ¡cono', 30.00, 'monthly', 'Assinatura mensal para diÃ¡conos'),
    ('Plano Mensal Membro', 20.00, 'monthly', 'Assinatura mensal para membros');
    ```

5. [ ] Verificar RLS policies:
    ```bash
    supabase db execute "SELECT * FROM pg_policies WHERE tablename = 'member_types'"
    ```

6. [ ] Se necessÃ¡rio, criar policy de leitura pÃºblica:
    ```sql
    CREATE POLICY "Allow public read active member types"
    ON member_types FOR SELECT
    USING (is_active = true);
    ```

7. [ ] Testar query do hook:
    ```bash
    supabase db execute "
    SELECT 
      id, name, description, sort_order, is_active, created_at, updated_at
    FROM member_types
    WHERE is_active = true
    ORDER BY sort_order
    "
    ```

VerificaÃ§Ã£o:
- [ ] Tabelas existem e tÃªm dados
- [ ] RLS permite leitura pÃºblica
- [ ] Query do hook retorna dados
- [ ] Frontend carrega tipos de membro

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
CHECKPOINT FASE 1
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Antes de prosseguir para Fase 2, verificar:

âœ… CritÃ©rios de Sucesso:
- [ ] Chaves antigas removidas do Git
- [ ] Chaves novas funcionando
- [ ] CLI linkado e operacional
- [ ] types.ts gerado corretamente
- [ ] Member types carregando no frontend
- [ ] PÃ¡gina de filiaÃ§Ã£o funcional

âŒ Se algum critÃ©rio falhar:
- PARAR e resolver antes de continuar
- NÃ£o prosseguir para Fase 2

================================================================================
FASE 2: ESTABILIZAÃ‡ÃƒO (DIAS 2-3)
================================================================================
Objetivo: Garantir funcionalidade bÃ¡sica e seguranÃ§a
Prioridade: ALTA
Tempo Estimado: 16 horas

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 2.1: VALIDAÃ‡ÃƒO - Implementar ValidaÃ§Ã£o de CPF/CNPJ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸŸ  ALTA
Tempo: 2 horas
ResponsÃ¡vel: Frontend

Arquivos a Modificar:
- src/hooks/useFormValidation.ts
- src/components/payments/PaymentFormEnhanced.tsx

ImplementaÃ§Ã£o:
```typescript
// Adicionar ao useFormValidation.ts
export const validateCPF = (cpf: string): boolean => {
  cpf = cpf.replace(/[^\d]/g, '');
  if (cpf.length !== 11) return false;
  
  // Validar dÃ­gitos verificadores
  let sum = 0;
  for (let i = 0; i < 9; i++) {
    sum += parseInt(cpf.charAt(i)) * (10 - i);
  }
  let digit = 11 - (sum % 11);
  if (digit >= 10) digit = 0;
  if (digit !== parseInt(cpf.charAt(9))) return false;
  
  sum = 0;
  for (let i = 0; i < 10; i++) {
    sum += parseInt(cpf.charAt(i)) * (11 - i);
  }
  digit = 11 - (sum % 11);
  if (digit >= 10) digit = 0;
  if (digit !== parseInt(cpf.charAt(10))) return false;
  
  return true;
};
```

VerificaÃ§Ã£o:
- [ ] CPF vÃ¡lido aceito
- [ ] CPF invÃ¡lido rejeitado
- [ ] Mensagem de erro clara
- [ ] ValidaÃ§Ã£o no frontend e backend

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 2.2: SEGURANÃ‡A - Validar Assinatura de Webhooks
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸŸ  ALTA
Tempo: 3 horas
ResponsÃ¡vel: Backend

Arquivo: supabase/functions/asaas-webhook/index.ts

ImplementaÃ§Ã£o:
```typescript
import { createHmac } from 'crypto';

function validateWebhookSignature(
  payload: string,
  signature: string,
  secret: string
): boolean {
  const hmac = createHmac('sha256', secret);
  hmac.update(payload);
  const expectedSignature = hmac.digest('hex');
  return signature === expectedSignature;
}

// No handler do webhook:
const signature = req.headers.get('x-asaas-signature');
const rawBody = await req.text();

if (!validateWebhookSignature(rawBody, signature, WEBHOOK_SECRET)) {
  return new Response('Invalid signature', { status: 401 });
}
```

VerificaÃ§Ã£o:
- [ ] Webhook com assinatura vÃ¡lida aceito
- [ ] Webhook com assinatura invÃ¡lida rejeitado
- [ ] Logs de tentativas invÃ¡lidas
- [ ] Alertas de seguranÃ§a configurados

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 2.3: RESILIÃŠNCIA - Implementar Retry em Webhooks
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸŸ  ALTA
Tempo: 4 horas
ResponsÃ¡vel: Backend

Criar tabela de fila de webhooks:
```sql
CREATE TABLE webhook_queue (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  event_type TEXT NOT NULL,
  payload JSONB NOT NULL,
  attempts INTEGER DEFAULT 0,
  max_attempts INTEGER DEFAULT 3,
  status TEXT DEFAULT 'pending',
  last_error TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  processed_at TIMESTAMPTZ
);
```

Implementar processamento com retry:
```typescript
async function processWebhookWithRetry(event: WebhookEvent) {
  const maxRetries = 3;
  let attempt = 0;
  
  while (attempt < maxRetries) {
    try {
      await processWebhook(event);
      return { success: true };
    } catch (error) {
      attempt++;
      if (attempt >= maxRetries) {
        await logFailedWebhook(event, error);
        throw error;
      }
      await sleep(Math.pow(2, attempt) * 1000); // Backoff exponencial
    }
  }
}
```

VerificaÃ§Ã£o:
- [ ] Webhooks com falha temporÃ¡ria sÃ£o retentados
- [ ] Backoff exponencial funciona
- [ ] Falhas permanentes sÃ£o logadas
- [ ] Dashboard mostra webhooks falhados

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 2.4: BANCO DE DADOS - Adicionar Foreign Keys
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸŸ  ALTA
Tempo: 2 horas
ResponsÃ¡vel: DBA

Criar migraÃ§Ã£o:
```sql
-- Adicionar FKs faltantes
ALTER TABLE asaas_cobrancas
ADD CONSTRAINT fk_asaas_cobrancas_user
FOREIGN KEY (user_id) REFERENCES profiles(id) ON DELETE CASCADE;

ALTER TABLE affiliate_commissions
ADD CONSTRAINT fk_affiliate_commissions_affiliate
FOREIGN KEY (affiliate_id) REFERENCES affiliates(id) ON DELETE CASCADE;

ALTER TABLE solicitacoes_servicos
ADD CONSTRAINT fk_solicitacoes_servicos_user
FOREIGN KEY (user_id) REFERENCES profiles(id) ON DELETE CASCADE;

-- Adicionar Ã­ndices
CREATE INDEX idx_asaas_cobrancas_user_id ON asaas_cobrancas(user_id);
CREATE INDEX idx_asaas_cobrancas_asaas_id ON asaas_cobrancas(asaas_id);
CREATE INDEX idx_affiliates_referral_code ON affiliates(referral_code);
CREATE INDEX idx_profiles_email ON profiles(email);
```

VerificaÃ§Ã£o:
- [ ] Foreign keys criadas
- [ ] Ãndices criados
- [ ] Performance de queries melhorada
- [ ] Integridade referencial garantida

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 2.5: LOGGING - Implementar Sistema de Logs
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸŸ  ALTA
Tempo: 3 horas
ResponsÃ¡vel: Backend

Criar tabela de logs:
```sql
CREATE TABLE system_logs (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  level TEXT NOT NULL, -- error, warn, info, debug
  category TEXT NOT NULL, -- webhook, payment, auth, etc
  message TEXT NOT NULL,
  metadata JSONB,
  user_id UUID REFERENCES profiles(id),
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_system_logs_level ON system_logs(level);
CREATE INDEX idx_system_logs_category ON system_logs(category);
CREATE INDEX idx_system_logs_created_at ON system_logs(created_at);
```

Implementar helper de logging:
```typescript
export async function log(
  level: 'error' | 'warn' | 'info' | 'debug',
  category: string,
  message: string,
  metadata?: any,
  userId?: string
) {
  await supabase.from('system_logs').insert({
    level,
    category,
    message,
    metadata,
    user_id: userId
  });
  
  // TambÃ©m logar no console
  console[level](`[${category}] ${message}`, metadata);
}
```

VerificaÃ§Ã£o:
- [ ] Logs sendo salvos no banco
- [ ] Logs visÃ­veis no dashboard admin
- [ ] Filtros funcionando
- [ ] Performance adequada

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 2.6: TESTES - Implementar Testes CrÃ­ticos
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸŸ  ALTA
Tempo: 4 horas
ResponsÃ¡vel: QA + Desenvolvedores

Testes a Implementar:

1. [ ] Teste de carregamento de member_types:
```typescript
// src/__tests__/hooks/useMemberTypeWithPlan.test.ts
import { renderHook, waitFor } from '@testing-library/react';
import { useMemberTypeWithPlan } from '@/hooks/useMemberTypeWithPlan';

describe('useMemberTypeWithPlan', () => {
  it('should load member types', async () => {
    const { result } = renderHook(() => useMemberTypeWithPlan());
    
    await waitFor(() => {
      expect(result.current.isLoading).toBe(false);
    });
    
    expect(result.current.memberTypes.length).toBeGreaterThan(0);
  });
});
```

2. [ ] Teste de validaÃ§Ã£o de CPF:
```typescript
// src/__tests__/utils/validation.test.ts
import { validateCPF } from '@/utils/validation';

describe('validateCPF', () => {
  it('should accept valid CPF', () => {
    expect(validateCPF('123.456.789-09')).toBe(true);
  });
  
  it('should reject invalid CPF', () => {
    expect(validateCPF('123.456.789-00')).toBe(false);
  });
});
```

3. [ ] Teste de processamento de webhook:
```typescript
// supabase/functions/asaas-webhook/__tests__/index.test.ts
import { processWebhook } from '../index';

describe('Webhook Processing', () => {
  it('should process payment confirmation', async () => {
    const event = {
      event: 'PAYMENT_CONFIRMED',
      payment: { id: 'pay_123', value: 50.00 }
    };
    
    const result = await processWebhook(event);
    expect(result.success).toBe(true);
  });
});
```

VerificaÃ§Ã£o:
- [ ] Testes executando com sucesso
- [ ] Cobertura mÃ­nima de 50%
- [ ] CI/CD configurado para rodar testes

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
CHECKPOINT FASE 2
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… CritÃ©rios de Sucesso:
- [ ] ValidaÃ§Ãµes implementadas
- [ ] Webhooks seguros e resilientes
- [ ] Foreign keys e Ã­ndices criados
- [ ] Sistema de logs funcionando
- [ ] Testes crÃ­ticos implementados

================================================================================
FASE 3: OTIMIZAÃ‡ÃƒO (DIAS 4-7)
================================================================================
Objetivo: Melhorar performance e UX
Prioridade: MÃ‰DIA
Tempo Estimado: 24 horas

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 3.1: PERFORMANCE - Implementar Lazy Loading
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸŸ¡ MODERADA
Tempo: 3 horas

Modificar App.tsx:
```typescript
import { lazy, Suspense } from 'react';

const Dashboard = lazy(() => import('@/pages/dashboard/Dashboard'));
const AdminUsers = lazy(() => import('@/pages/admin/UsersAdmin'));
// ... outros imports lazy

// No componente:
<Suspense fallback={<LoadingSpinner />}>
  <Routes>
    <Route path="/dashboard" element={<Dashboard />} />
    {/* ... */}
  </Routes>
</Suspense>
```

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 3.2: UX - Adicionar Loading Skeletons
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸŸ¡ MODERADA
Tempo: 4 horas

Criar componente de skeleton:
```typescript
// src/components/ui/skeleton.tsx
export function MemberTypeSkeleton() {
  return (
    <div className="space-y-4 animate-pulse">
      <div className="h-12 bg-gray-200 rounded" />
      <div className="h-32 bg-gray-200 rounded" />
      <div className="h-32 bg-gray-200 rounded" />
    </div>
  );
}
```

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 3.3: PERFORMANCE - Otimizar Queries
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸŸ¡ MODERADA
Tempo: 4 horas

Analisar e otimizar queries lentas:
```sql
-- Identificar queries lentas
SELECT * FROM pg_stat_statements
ORDER BY mean_exec_time DESC
LIMIT 10;

-- Adicionar Ã­ndices necessÃ¡rios
CREATE INDEX CONCURRENTLY idx_name ON table(column);
```

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 3.4: CÃ“DIGO - Refatorar Componentes Grandes
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸŸ¡ MODERADA
Tempo: 8 horas

Componentes a Refatorar:
- PerfilCompleto.tsx (61KB) â†’ Dividir em 5 componentes
- MemberTypeSelector.tsx (13KB) â†’ Dividir em 3 componentes
- ContactContentEdit.tsx (25KB) â†’ Dividir em 4 componentes

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 3.5: MONITORAMENTO - Configurar Sentry
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸŸ¡ MODERADA
Tempo: 2 horas

Instalar e configurar:
```bash
npm install @sentry/react @sentry/tracing
```

```typescript
// src/main.tsx
import * as Sentry from "@sentry/react";

Sentry.init({
  dsn: "https://...@sentry.io/...",
  integrations: [new Sentry.BrowserTracing()],
  tracesSampleRate: 1.0,
});
```

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 3.6: DOCUMENTAÃ‡ÃƒO - Criar DocumentaÃ§Ã£o TÃ©cnica
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸŸ¡ MODERADA
Tempo: 3 horas

Documentos a Criar:
- [ ] README.md atualizado
- [ ] CONTRIBUTING.md
- [ ] API.md (documentaÃ§Ã£o de Edge Functions)
- [ ] DEPLOYMENT.md
- [ ] TROUBLESHOOTING.md

================================================================================
FASE 4: CONSOLIDAÃ‡ÃƒO (DIAS 8-14)
================================================================================
Objetivo: Preparar para produÃ§Ã£o
Prioridade: MÃ‰DIA
Tempo Estimado: 40 horas

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 4.1: AMBIENTE - Criar Staging
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸŸ  ALTA
Tempo: 4 horas

1. [ ] Criar projeto Supabase de staging
2. [ ] Configurar variÃ¡veis de ambiente
3. [ ] Aplicar migraÃ§Ãµes
4. [ ] Popular com dados de teste
5. [ ] Configurar deploy automÃ¡tico

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 4.2: TESTES - Implementar Testes E2E
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸŸ  ALTA
Tempo: 16 horas

Usar Playwright ou Cypress:
```typescript
// e2e/filiacao.spec.ts
test('complete affiliation flow', async ({ page }) => {
  await page.goto('/filiacao');
  await page.selectOption('#member-type', 'Pastor');
  await page.fill('#name', 'Teste E2E');
  await page.fill('#email', 'teste@e2e.com');
  await page.fill('#cpf', '123.456.789-09');
  await page.click('#submit');
  await expect(page).toHaveURL('/pagamento-sucesso');
});
```

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 4.3: SEGURANÃ‡A - Auditoria Completa
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸ”´ CRÃTICA
Tempo: 8 horas

Executar:
1. [ ] OWASP ZAP scan
2. [ ] npm audit
3. [ ] AnÃ¡lise de dependÃªncias
4. [ ] RevisÃ£o de RLS policies
5. [ ] Teste de penetraÃ§Ã£o bÃ¡sico

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 4.4: BACKUP - Configurar Backup Automatizado
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸŸ  ALTA
Tempo: 4 horas

Configurar:
1. [ ] Backup diÃ¡rio do banco de dados
2. [ ] Backup de arquivos do storage
3. [ ] RetenÃ§Ã£o de 30 dias
4. [ ] Testes de restauraÃ§Ã£o

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TAREFA 4.5: CI/CD - Configurar Pipeline
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severidade: ðŸŸ  ALTA
Tempo: 8 horas

Criar .github/workflows/ci.yml:
```yaml
name: CI/CD
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-node@v2
      - run: npm ci
      - run: npm test
      - run: npm run build
```

================================================================================
CHECKLIST FINAL PRÃ‰-PRODUÃ‡ÃƒO
================================================================================

SEGURANÃ‡A:
- [ ] Chaves antigas removidas e rotacionadas
- [ ] Auditoria de seguranÃ§a completa
- [ ] Pentest realizado
- [ ] Vulnerabilidades corrigidas
- [ ] RLS policies testadas
- [ ] ValidaÃ§Ã£o de entrada em todos os formulÃ¡rios

FUNCIONALIDADE:
- [ ] FiliaÃ§Ã£o funcionando end-to-end
- [ ] Pagamentos testados (sandbox)
- [ ] Webhooks funcionando
- [ ] Split de comissÃµes funcionando
- [ ] Carteira digital sendo gerada
- [ ] Emails sendo enviados

INFRAESTRUTURA:
- [ ] CLI linkado e funcional
- [ ] types.ts atualizado
- [ ] MigraÃ§Ãµes aplicadas
- [ ] Backup configurado
- [ ] Monitoramento ativo
- [ ] Logs centralizados

QUALIDADE:
- [ ] Testes unitÃ¡rios > 50% cobertura
- [ ] Testes E2E crÃ­ticos implementados
- [ ] Performance aceitÃ¡vel (< 3s load)
- [ ] Sem erros no console
- [ ] DocumentaÃ§Ã£o completa

DEPLOY:
- [ ] Staging testado
- [ ] CI/CD configurado
- [ ] Rollback plan definido
- [ ] Equipe treinada
- [ ] Monitoramento configurado

================================================================================
ESTIMATIVAS FINAIS
================================================================================

Tempo Total Estimado:
- Fase 1 (EmergÃªncia): 8 horas
- Fase 2 (EstabilizaÃ§Ã£o): 16 horas
- Fase 3 (OtimizaÃ§Ã£o): 24 horas
- Fase 4 (ConsolidaÃ§Ã£o): 40 horas
TOTAL: 88 horas (11 dias Ãºteis)

Equipe Recomendada:
- 1 DevOps/SeguranÃ§a
- 2 Backend Developers
- 1 Frontend Developer
- 1 QA Engineer
- 1 DBA (part-time)

Custo Estimado (variÃ¡vel):
- Equipe: Depende de salÃ¡rios
- Ferramentas: ~$200/mÃªs (Sentry, etc)
- Infraestrutura: ~$100/mÃªs (Staging)

Risco se NÃ£o Executado:
ðŸ”´ ALTÃSSIMO - Sistema inseguro e nÃ£o funcional

================================================================================
FIM DO PLANO DE AÃ‡ÃƒO
================================================================================
